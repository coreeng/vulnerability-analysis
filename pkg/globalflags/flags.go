package globalflags

import (
	"github.com/pkg/errors"
	"github.com/spf13/cobra"
)

const (
	// ConfigFlag represents the name of the config flag
	ConfigFlag = "config"
)

var (
	config string
)

// Config returns value of a --config flag
func Config(cmd *cobra.Command) (*string, error) {
	n, err := cmd.Flags().GetString(ConfigFlag)
	if err != nil {
		return nil, errors.Wrapf(err, "Failed to retrieve command line flag %s, err: %v", ConfigFlag, err)
	}
	return &n, nil
}

// InitGlobalCmdFlags initialises global command flags
func InitGlobalCmdFlags(cmd *cobra.Command) {
	cmd.PersistentFlags().StringVarP(&config, ConfigFlag, "c", "./config/config.yaml", "config")
}
