ENVTEST_K8S_VERSION="1.28.0"
ENVTEST=setup-envtest
LOCALBIN="./bin"
ENVTEST_VERSION:=v0.0.0-20240320141353-395cfc7486e6

.PHONY: default
default: help

.PHONY: help
help: Makefile
	@echo "Usage: "
	@sed -n 's/^##[ -]/   /p' Makefile
	@echo ""


## make build					Build golang app
.PHONY: build
build: 
	go build -o vulcheck ./cmd/vulnerability-analysis/main.go

## make test					Run unit tests for golang app
.PHONY: test
test: 
	@go test ./...  

## make run					Runs golang app
.PHONY: run
run: build
	./vulcheck trivy argocd index.docker.io/bitnami/etcd:3.5.12-debian-11-r3

setup:
	@curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64 ; \
	sudo install minikube-linux-amd64 /usr/local/bin/minikube && rm minikube-linux-amd64
